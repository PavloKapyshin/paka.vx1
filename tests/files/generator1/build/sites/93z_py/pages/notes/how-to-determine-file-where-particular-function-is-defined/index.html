<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>How to determine file where particular function is defined ← Notes ← py.93z.org</title><link rel="stylesheet" href="/s/styles.css"><link rel="alternate" type="application/atom+xml" href="/notes/feed/" title="Recent notes from py.93z.org"></head><body><div class="h"><ol class="h-bc"><li><a href="/" rel="home">py.93z.org</a></li><li class="last"><a href="/notes/">Notes</a></li></ol></div><div class="c"><div class="c-i"><div class="c-p"><h1>How to determine file where particular function is defined</h1><div class="n-b"><p>...at execution time, given that all you have is an instance of function object:</p><pre><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<span class="go">&lt;class &#39;function&#39;&gt;</span>
</code></pre><p>Knowing where it is defined may save you some time during debugging session: say, when you are not sure that function you are dealing with is imported from “correct” location. Despite being easy, such sanity check may help.</p><p>Most obvious option is to use <code>co_filename</code> attribute of function’s code:</p><pre><code><span class="gp">&gt;&gt;&gt; </span><span class="n">func</span><span class="o">.</span><span class="vm">__code__</span><span class="o">.</span><span class="n">co_filename</span>
<span class="go">&#39;/home/user/.../something.py&#39;</span>
</code></pre><p>This also may work with methods:</p><pre><code><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">SomeClass</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">some_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">pass</span>
<span class="gp">... </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span> <span class="o">=</span> <span class="n">SomeClass</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">some_method</span><span class="o">.</span><span class="vm">__code__</span><span class="o">.</span><span class="n">co_filename</span>
<span class="go">&#39;&lt;stdin&gt;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">some_method</span><span class="o">.</span><span class="vm">__func__</span><span class="o">.</span><span class="vm">__code__</span><span class="o">.</span><span class="n">co_filename</span>
<span class="go">&#39;&lt;stdin&gt;&#39;</span>
</code></pre><p>Usually it’s better to use <code>inspect.getsourcefile</code> (that uses <code>inspect.getfile</code>, which uses something similar to above, but in more consistent way—for many different types):</p><pre><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">inspect</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inspect</span><span class="o">.</span><span class="n">getsourcefile</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<span class="go">&#39;/home/user/.../something.py&#39;</span>
</code></pre><p>But if <code>func</code> is defined in CPython extension (that is shared library which uses C API), <code>inspect.getsourcefile</code> will fail with <code>TypeError</code>:</p><pre><code><span class="gp">&gt;&gt;&gt; </span><span class="n">inspect</span><span class="o">.</span><span class="n">getsourcefile</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
  File <span class="nb">&quot;/home/user/.../lib/python3.4/inspect.py&quot;</span>, line <span class="m">571</span>, in <span class="n">getsourcefile</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">getfile</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
  File <span class="nb">&quot;/home/user/.../lib/python3.4/inspect.py&quot;</span>, line <span class="m">536</span>, in <span class="n">getfile</span>
    <span class="s1">&#39;function, traceback, frame, or code object&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">object</span><span class="p">))</span>
<span class="gr">TypeError</span>: <span class="n">&lt;built-in function func&gt; is not a module, class, method, function, traceback, frame, or code object</span>
</code></pre><p>In such case it is still possible to get file path of <code>.so</code>:</p><pre><code><span class="gp">&gt;&gt;&gt; </span><span class="n">inspect</span><span class="o">.</span><span class="n">getfile</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getmodule</span><span class="p">(</span><span class="n">func</span><span class="p">))</span>
<span class="go">&#39;/home/user/.../lib/python3.4/site-packages/something.cpython-34m.so&#39;</span>
</code></pre></div></div><div class="c-s"><div class="c-s-s"><h6>Note metadata</h6><dl class="nm-l"><dt>Publication date</dt><dd>April 5, 2016</dd><dt>Tags</dt><dd><ol class="t-l"><li><a href="/tags/cpython/">CPython</a></li></ol></dd></dl></div><div class="c-s-s"><h6>About</h6><p>This is “all things Python” blog &amp; I hope some notes are helpful.</p></div><div class="c-s-s"><h6>Recent notes</h6><ol class="n-l"><li><a href="/notes/automatic-html-escaping-in-mako/">Automatic &lt;HTML&gt; escaping in Mako</a></li><li><a href="/notes/how-to-create-.tar.gz-reproducibly/">How to create .tar.gz reproducibly (putting it together)</a></li><li><a href="/notes/how-to-create-.gz-reproducibly/">How to create .gz reproducibly</a></li><li><a href="/notes/how-to-create-.tar-reproducibly/">How to create .tar reproducibly</a></li><li><a href="/notes/reproducible-builds-and-django.utils.feedgenerator/">Reproducible builds and django.utils.feedgenerator</a></li><li class="a-o"><span class="a">How to determine file where particular function is defined</span></li><li><a href="/notes/python-m-compatibility/">python -m compatibility</a></li><li><a href="/notes/sort-dict-keys-by-values/">Sort dict’s keys by values</a></li></ol><p><a href="/notes/">All notes</a></p></div></div></div></div><div class="f"><div class="f-i"><div class="f-a"><p>© 2010–2017 py.93z.org</p></div><div class="f-s"><ol class="f-nw"><li><a href="//dev.93z.org">dev.93z.org</a></li><li class="a-o"><a href="/" rel="home" class="a">py.93z.org</a></li></ol></div></div></div><script src="/s/scripts.js" type="text/javascript"></script></body></html>